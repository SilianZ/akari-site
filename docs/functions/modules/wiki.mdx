---
description: 此模块可以查询一个基于 MediaWiki 的网站的指定页面的详情
slug: /wiki
---

# wiki

-   [开源](/docs/help/faq#为什么有些模块没有开源)

此模块可以查询一个基于 MediaWiki 的网站的指定页面的详情。

## `wiki`

-   [公开](permissions)

用法：`~wiki [<Interwiki>:]<页面名> [-l <语言>]`

参数：

-   `-l`：查找页面的对应语言版本，若无结果则返回当前语言。

此命令可以查询一个基于 MediaWiki 的网站的指定页面的详情。Interwiki 若留空则为默认 Wiki。

![](https://z1.ax1x.com/2023/11/18/piN0Tkq.png)

（返回 Infobox 示例）

若页面中存在 Infobox，则会渲染并展示页面中的 Infobox 图片。

:::warning

某些网站已经被列入黑名单，使用此命令无法获取某些网站的某些信息。即使网站不在黑名单内，返回的内容仍将经过小可云智能过滤。请不要作死。

:::

## `wiki id`

-   [公开](permissions)

用法：`~wiki id [<Interwiki>:]<页面 ID>`

此命令可以根据页面 ID 搜索一个 Wiki 页面。

Interwiki 若留空则为默认 Wiki。

:::warning

某些网站已经被列入黑名单，使用此命令无法获取某些网站的某些信息。即使网站不在黑名单内，返回的内容仍将经过小可云智能过滤。请不要作死。

:::

## `wiki search`

-   [公开](permissions)

用法：`~wiki search <关键词>`

此命令会根据根据关键词搜索 Wiki 页面。

## `wiki random`

-   [公开](permissions)

用法：`~wiki random`

此命令会随机查询一个基于 MediaWiki 的网站的指定页面的详情。

## `wiki set`

-   [仅管理员](permissions)
-   别名：`wiki_start_site`

用法：`~wiki set <wiki 域名/脚本路径>`

此命令可以设置使用 `wiki` 命令时的默认 Wiki。每个群只能设置一个默认 Wiki。

尽管链接可以直接填写 Wiki 的 URL，但机器人的自动检测可能会出错。

:::tip 脚本路径

“脚本路径”指的是 wiki 的 index.php、api.php 所在的目录。

-   在 WMF 所属的网站（维基百科、维基词典等）和 Miraheze 农场，此目录在 `<域名>/w/`。
-   在 Fandom 农场的英文 wiki 上，此目录在 `<域名>`。
-   在 Fandom 农场的其他语言 wiki 上，此目录在 `<域名>/<语言代码>/`。

如果您的 wiki 是自行搭建的，或您的农场没有在此列出，下面是获取脚本路径的方法。

1. 在搜索框内输入：`Special:Version`。
2. 打开页面后，向下滑，找到第二个表格。对于中文 wiki 来说，此表格的名称为“接入点URL”。
3. 找到此表格的第二行（对于中文 wiki 来说，这一行的表头为“脚本路径”）第二列（对于中文 wiki 来说，这一列的表头为“URL”）内容。右键此字符并复制链接，即为此 wiki 的脚本路径。

:::

## `wiki iw`

-   [仅管理员](permissions)
-   别名：`interwiki`

用法：

-   添加新的 Interwiki：`~wiki iw add <Interwiki 名称> <Wiki 域名/脚本路径>`
-   删除现有的 Interwiki：`~wiki iw remove <Interwiki 名称>`
-   查看当前设置 Interwiki 列表：`~wiki iw list [legacy]`
-   获取 API 地址：`~wiki iw get <Interwiki 名称>`

此命令可以设置使用 `wiki` 命令时的 Interwiki。设置完毕后，可以在使用 `wiki` 时在前面加上 Interwiki 的名称加**英文**冒号（`:`）以获取此 Wiki 的内容。

此命令可以设置使用 Wiki 命令时的 Interwiki。设置完毕后，可以在使用 Wiki 时在前面加上 Interwiki 的名称加英文冒号（:）以获取此 Wiki 的内容。

尽管链接可以直接填写 Wiki 的 URL，但机器人的自动检测可能会出错。

:::tip 脚本路径

“脚本路径”指的是 wiki 的 index.php、api.php 所在的目录。

-   在 WMF 所属的网站（维基百科、维基词典等）和 Miraheze 农场，此目录在 `<域名>/w/`。
-   在 Fandom 农场的英文 wiki 上，此目录在 `<域名>`。
-   在 Fandom 农场的其他语言 wiki 上，此目录在 `<域名>/<语言代码>/`。

如果您的 wiki 是自行搭建的，或您的农场没有在此列出，下面是获取脚本路径的方法。

1. 在搜索框内输入：`Special:Version`。
2. 打开页面后，向下滑，找到第二个表格。对于中文 wiki 来说，此表格的名称为“接入点URL”。
3. 找到此表格的第二行（对于中文 wiki 来说，这一行的表头为“脚本路径”）第二列（对于中文 wiki 来说，这一列的表头为“URL”）内容。右键此字符并复制链接，即为此 wiki 的脚本路径。

:::

## `wiki headers`

-   [仅管理员](permissions)

用法：

-   设置新的请求标头：`~wiki headers add <请求标头>`
-   删除请求标头：`~wiki headers remove <请求标头>`
-   重置请求标头：`~wiki headers reset`
-   查看当前设置请求标头：`~wiki headers show`

此命令用于设置使用 `wiki` 命令时的请求标头。设置完毕后，每一次查询 Wiki 都会使其带上此标头查询。

不同标头之间使用换行隔开。

如果你不清楚这有什么用，那么请不要乱设置，否则可能导致返回结果异常。

:::info 关于灰机 wiki

面对近期的攻击，我们发现灰机对部分 wiki 采用了“部分封站”的措施，即限制网站，仅可使“狗头人”APP 用户访问。小可受波及，但可通过**伪装狗头人APP的`User-Agent`**解决。请运行以下命令：

```
~wiki headers set {"user-agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X x.y; rv:42.0) Gecko/20100101 Firefox/42.0 Huijiapp/5"}
```

:::

## `wiki prefix`

-   [仅管理员](permissions)

用法：

-   设置新的前缀：`~wiki prefix set <前缀>`
-   重置前缀：`~wiki prefix reset`

此命令用于设置使用`wiki`命令时时自动添加的前缀。设置完毕后，每一次查询 Wiki 都会使其带上此前缀查询。

## `wiki fandom`

-   [仅管理员](permissions)
-   [设置](/docs/help/reading#命令类型)

用法：`~wiki fandom`

此命令可以切换是否开启 Fandom 全局 Interwiki 查询。

Fandom全局查询用法：

-   命令：`~wiki w:c:<Wiki 名>:[<Interwiki>]:<页面名>`
-   行内：`[[w:c:<Wiki 名>:[<Interwiki>]:<页面名>]]`

## `wiki redlink`

-   [仅管理员](permissions)
-   [设置](/docs/help/reading#命令类型)

用法：`~wiki redlink`

此命令可以切换是否开启页面不存在时返回编辑链接。
